#
# Python project generator by Parra Studios
# Copyright (C) 2016 Vicente Eduardo Ferrer Garcia <vic798@gmail.com>
#
# Generates a python project embedded into CMake
#

# Target name
set(target @PACKAGE_NAME@)

# Exit here if required dependencies are not met
message(STATUS "Script @PACKAGE_NAME@")

# Set custom setup command
add_custom_command(OUTPUT  "@PACKAGE_OUTPUT@"
                   COMMAND "${PYTHON_EXECUTABLE}" "@PACKAGE_SETUP_PY@" build
                   COMMAND "${CMAKE_COMMAND}" -E touch "@PACKAGE_OUTPUT@"
                   DEPENDS "@PACKAGE_DEPS@")

# Set custom target
#add_custom_target(@PACKAGE_NAME@ ALL DEPENDS @PACKAGE_OUTPUT@)

#
# Deployment
#

# Install cmake python config
install(FILES  "${CMAKE_CURRENT_BINARY_DIR}/@PACKAGE_NAME@/python-@PACKAGE_NAME@-config.cmake"
    DESTINATION ${INSTALL_CMAKE}/@PACKAGE_NAME@
    COMPONENT   runtime
)

# Deploy generated config file
install(CODE   "execute_process(COMMAND ${PYTHON_EXECUTABLE} @PACKAGE_SETUP_PY@ install)"
    COMPONENT   runtime
)

# CMake config
#install(EXPORT  @PACKAGE_NAME@-export
#    NAMESPACE   ${META_PROJECT_NAME}::
#    DESTINATION ${INSTALL_CMAKE}/@PACKAGE_NAME@
#    COMPONENT   dev
#)

